HPS (HermesProbability Science)

一门让概率变得可计算、让随机变得可理解的领域专用语言。

HPS 用极简的符号系统，让你能够描述任何抽卡系统、模拟随机过程、分析统计数据、设计保底机制。无论你是游戏设计师、数据分析师，还是单纯对抽卡感兴趣的玩家，HPS 都能帮你把模糊的概率直觉变成精确的可执行代码。

---

✨ 特性

· 极简符号 – 每个符号只有一种核心含义，看一眼就能猜个大概。
· 玩家视角 – 语法从“我想要什么”出发（如 <目标,#池子×:方式,*保底>）。
· 概率池系统 – 轻松定义任意复杂的抽卡池。
· 目标声明 – 将保底、抽卡方式、目标物品封装成一行，驱动模拟器自动执行。
· 经济系统 – 内置货币符号 ¥，支持预算、花费、充值模拟。
· 循环记录 – #¢{}± 可批量实验，自动统计成功率，验证大数定律。
· 数学与统计 – 支持对数、指数、三角函数、方差、置信区间等。
· 函数定义 – 用 ¢.函数名() 封装常用逻辑，实现代码复用。
· 可扩展 – 从基础概率逐步进化到完整编程语言，所有特性自然融

---

📖 语言指南

1. HPS 是什么？

HPS 是一门专门用来处理概率问题的编程语言。它的设计理念是：

· 极简：用最少的符号表达最丰富的含义。
· 直观：符号形状与含义关联，看一眼就能猜个大概。
· 面向玩家：语法从“我想要什么”出发，而不是从“计算机如何实现”出发。

2. 基础符号系统

标识符（谁/什么/多少）

符号 名称 含义 示例
@ 玩家符 抽卡的主体 @1 表示玩家1
$ 物品符 抽卡的目标物品 $1 表示物品1
# 变量符 数字或状态 #抽数
¥ 货币符 货币或额度 ¥100
¢ 元符 注释、输出、函数 ¢,你好

规则：每个标识符只能用于它的领域，不能混用。例如 @池子 是错误的，因为池子要用 #。

操作符（怎么做）

符号 名称 含义 示例
/ 概率符 标记一个数值为概率 0.1/ 表示0.1%
: 重复符 连续操作 0.1/:2 连续两次
- 并行符 多人同时 0.1/:2-10 10人各连续两次
⇒ 顺序符 然后/导致 抽卡 ⇒ 扣钱
? 条件符 如果 ?($1=) ⇒ 停
= 等于符 判断相等 ($1=) 表示已抽到
≠ 不等符 判断不等 ($1≠) 表示未抽到
& 数学符 数学运算 &A(1+2×3) 计算7
! 错误符 错误提示 !语法错误
\ 转义符 输出符号本身 \¢ 输出一个¢字符

括号（结构化）

符号 名称 用途 示例
[] 方括号 绑定概率与物品 [0.1/$1]
() 圆括号 定义概率池 (0.1/:$1,$2)#小池
{} 花括号 定义玩家动作 {@1,100} 抽卡
<> 尖括号 目标声明 <$1,#池子×:10,*90>
"" 引号 储存库 "#数据"

3. 概率的表达

基本概率

```
0.1/      ← 0.1%
50/       ← 50%
100/      ← 100%
```

科学计数法

```
1/-3      ← 1×10⁻³ = 0.001
1.7/-97   ← 1.7×10⁻⁹⁷
1/+80     ← 1×10⁸⁰（宇宙原子总数）
```

带系数的科学计数法

```
1.7/1/-97   ← 1.7×1×10⁻⁹⁷ = 1.7×10⁻⁹⁷
2.5/3/+4    ← 2.5×3×10⁴ = 75000
```

4. 物品和池子

物品

```
$1              ← 物品1
$雷电,5星       ← 名为“雷电”且品质为5星的物品
$甘雨,5星,冰    ← 带多个属性的物品
```

池子定义

```
(0.6/:$雷电,$甘雨)#角色UP
(1/:$1,$2,$3,$4)#四星池
```

池子引用

```
<#角色UP,:10>   ← 从角色UP池抽10连
```

5. 玩家和动作

玩家标识

```
@1    ← 玩家1
@2    ← 玩家2
@0    ← 所有玩家
@1-10 ← 玩家1到10
```

玩家动作

```
{@1,100} <#角色UP,:1>
{@1,10}
  <#池子,:1> ⇒ -¥160
  ?($1=) ⇒ ¢,出货！
```

6. 目标声明（HPS 的精髓）

```
<$目标物品, #池子 ×:抽卡方式, *保底数>
```

例如：

```
<$雷电,#角色UP×:10,*90>
```

7. 条件控制

```
?(#抽数 > 70) ⇒ ¢,软保底触发
?($雷电=) ⇒ ¢,出货了！，否则 ¢,继续努力
?($雷电=) ⇒ 停
```

8. 循环

while

```
while (¥ ≥ 160) {
  <#池子,:1> ⇒ -¥160
}
```

for

```
for #i = 1 to 90 {
  <#池子,:1>
}
```

until

```
until ($雷电=) {
  <#池子,:1>
}
```

记录循环

```
#¢{ (@1,100) | [0.006/$任意,5星] }± (1000)
```

9. 函数

```
¢.打招呼()
  ¢,你好！
¢.End

¢.期望(概率)
  return &A(1 ÷ 概率)
¢.End

#雷神期望 = 期望(0.006)
¢,期望抽数：#雷神期望
```

10. 经济系统

```
预算 = ¥10000
单价 = ¥160
预算 - 单价     ← 剩余
预算 ÷ 单价     ← 能抽的次数
¥R648 → ¥C6480   ← 648人民币换6480结晶
$¥ 表示所有货币的总和
```

11. 数学与统计

基础运算

```
&A(1+2×3)        ← 7
&A(10÷2)         ← 5
&A(2^10)         ← 1024
```

内置函数

函数 含义
㏒(x) 以10为底的对数
㏑(x) 自然对数
√(x) 平方根
sin(x) 正弦
exp(x) e的x次方
avg(a,b,c) 平均值
var(a,b,c) 方差
std(a,b,c) 标准差

精度控制

```
π:5       ← 3.14159
1.7/-97:3 ← 1.700×10⁻⁹⁷
```

12. 储存库

```
"#历史数据,$1" ← 空
#¢实验{...}± (100)
"#历史数据,$1" ← #¢.成功
#成功次数 = "#历史数据,$1".#历史数据
```

13. 错误与转义

```
!语法错误
¢,输出 \$1  ← 显示 $1 而不是变量值
```

14. 完整示例 —— 原神抽卡模拟

```hps
¢==================================
¢  原神角色UP池抽卡模拟
¢==================================

(0.6/:$雷电,$甘雨,$胡桃)#角色UP
#目标 = $雷电,5星

预算 = ¥40000
单价 = ¥160
抽数 = 0
保底计数 = 0

{@1, while (预算 ≥ 单价) & (#目标≠)}
  <#角色UP,:1> ⇒ -¥160 ⇒ 抽数++ ⇒ 保底计数++
  
  ?(保底计数) > 70 ⇒ 
    ¢($任意,5星, ¢0.6 + (保底计数-70)×2)
  
  ?(保底计数) = 90 ⇒
    ¢(#目标, ¢100)
  
  ?($任意,5星=) ⇒ 
    ¢,出五星了！ 
    ?($雷电=) ⇒ ¢,🎉 是雷电！ 停
    ，否则 ¢,歪了... 保底计数重置
    保底计数 = 0

¢,===== 最终报告 =====
¢,目标：?(#目标=) ⇒ "成功" 否则 "失败"
¢,总抽数：#抽数
¢,花费：¥(抽数 × 单价)
¢,剩余预算：¥预算
```

---

📊 应用场景

场景 示例
游戏抽卡池设计 用 (概率/:物品) 定义池子，用保底语法设计机制
抽卡策略模拟 用循环和条件模拟不同策略，比较成功率
概率计算 用 &A() 计算期望、方差
数据统计 用 #¢{}± 批量实验，验证大数定律
经济分析 用 ¥ 预算，计算期望花费
教学演示 用 HPS 代码直观展示概率论概念

---

📘 语法速查表

标识符

符号 含义
@1 玩家1
$1 物品1
#抽数 变量
¥100 货币
¢ 注释/输出/函数

操作符

符号 含义
/ 概率标记
: 重复
- 并行/减法
⇒ 顺序
? 条件
= 等于
≠ 不等于
& 数学运算
! 错误
\ 转义

括号

符号 用途
[] 绑定概率与物品
() 定义概率池
{} 玩家动作
<> 目标声明
"" 储存库

数学常数

符号 值
π 3.14159...
e 2.71828...
φ 1.61803...
√2 1.41421...

---

🧪 练习

1. 练习1：定义一个池子，里面有3件物品，总概率1%，并输出池子定义成功的消息。
2. 练习2：声明一个目标：想要物品1，用单抽，90抽保底。
3. 练习3：写一个循环，抽到物品2为止，最多抽100次。
4. 练习4：定义一个函数，计算给定概率的期望抽数，并调用它。
5. 练习5：用 #¢{}± 进行1000次实验，每次抽100次，统计出货率。

---

🤝 贡献

HPS 还很年轻，欢迎任何形式的贡献！你可以：

· 提交 Issue 报告 bug 或提出新特性。
· 完善文档，增加更多示例。
· 实现更强大的解释器（Python/JavaScript/...）。
· 在社交网络分享 HPS，让更多人知道。

---

📄 许可证

MIT © [RECAT]

---

HPS：让概率变得可计算，让随机变得可理解。